!function(t){var e={};function n(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(r,s,function(e){return t[e]}.bind(null,s));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}({0:function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,s="~";function i(){}function a(t,e,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new function(t,e,n){this.fn=t,this.context=e,this.once=n||!1}(n,r||t,i),o=s?s+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],a]:t._events[o].push(a):(t._events[o]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function h(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(s=!1)),h.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(s?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},h.prototype.listeners=function(t){var e=s?s+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,a=new Array(i);r<i;r++)a[r]=n[r].fn;return a},h.prototype.listenerCount=function(t){var e=s?s+t:t,n=this._events[e];return n?n.fn?1:n.length:0},h.prototype.emit=function(t,e,n,r,i,a){var o=s?s+t:t;if(!this._events[o])return!1;var h,c,l=this._events[o],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,r),!0;case 5:return l.fn.call(l.context,e,n,r,i),!0;case 6:return l.fn.call(l.context,e,n,r,i,a),!0}for(c=1,h=new Array(d-1);c<d;c++)h[c-1]=arguments[c];l.fn.apply(l.context,h)}else{var u,f=l.length;for(c=0;c<f;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,n);break;case 4:l[c].fn.call(l[c].context,e,n,r);break;default:if(!h)for(u=1,h=new Array(d-1);u<d;u++)h[u-1]=arguments[u];l[c].fn.apply(l[c].context,h)}}return!0},h.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},h.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},h.prototype.removeListener=function(t,e,n,r){var i=s?s+t:t;if(!this._events[i])return this;if(!e)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||r&&!a.once||n&&a.context!==n||o(this,i);else{for(var h=0,c=[],l=a.length;h<l;h++)(a[h].fn!==e||r&&!a[h].once||n&&a[h].context!==n)&&c.push(a[h]);c.length?this._events[i]=1===c.length?c[0]:c:o(this,i)}return this},h.prototype.removeAllListeners=function(t){var e;return t?(e=s?s+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=s,h.EventEmitter=h,t.exports=h},1:function(t,e,n){"use strict";n.r(e),n(8);const r=new(n(0).EventEmitter);$(()=>{(new class{constructor(){this.data=null,this.current=null,this.index=0,this.answer=[],this.dom={examLang:$(".exam-lang"),examType:$(".exam-type"),currentNum:$(".current-num"),totalNum:$(".total-num"),des:$(".exam-des"),form:null,btns:$(".btn-group"),examUl:$(".exam-items")}}init(){this.getData(),r.on("getData",t=>{t.ret&&t.data&&(this.data=t,this.current=t.data[0],console.log(this.current),this.switchType(),this.updateHeader(),this.createMain(),this.createFooter(),this.hideLoading(),this.clickBtns(),this.clickItem())})}getData(){this.showLoading(),$.get("api/back").done(t=>{console.log(t),r.emit("getData",JSON.parse(t))})}showLoading(){}hideLoading(){}switchType(){let t=this.data.data,e=t.length;for(let n=0;n<e;n++)switch(t[n].type){case"radio":t[n].type="单选";break;case"checkbox":t[n].type="多选";break;default:t[n].type="简答"}}updateHeader(){let t=this.index;this.dom.examLang.text(this.current.lang),this.dom.examType.text(this.current.type),this.dom.currentNum.text(t+1),this.dom.totalNum.text(this.data.data.length)}createMain(){this.dom.form=$("<form>").addClass("exam-form"),"单选"===this.current.type?this.createChoice("radio"):"多选"===this.current.type?this.createChoice("checkbox"):this.createDefault(),this.dom.des.text(this.current.description)}createChoice(t){for(let e=0;e<4;e++){let n=$("<input>").addClass("custom-control-input").attr({type:t,name:`exam-${t}`,id:`exam-${t}-${e}`}),r=$("<label>").addClass("custom-control-label").attr("for",`exam-${t}-${e}`).text(this.current.content[e]),s=$("<div>").addClass(`custom-control custom-${t}`).append(n,r);this.dom.form.append(s)}this.dom.des.after(this.dom.form)}createDefault(){let t=$("<textarea>").attr({col:100,row:20});this.dom.form.append(t),this.dom.des.after(this.dom.form)}updateMain(){this.dom.form.remove(),this.current=this.data.data[this.index],this.createMain()}createFooter(){const t=this.data.data;let e=document.createDocumentFragment();for(let n=0,r=t.length;n<r;n++){let t=document.createElement("li");t.innerHTML=n+1,t.classList="exam-item",0===n&&(t.classList+=" answering"),e.appendChild(t)}this.dom.examUl[0].appendChild(e)}updateFooter(t){let e=this.dom.examUl.children().toArray(),n="number"==typeof t?$(e[t]):$(t);e.forEach(t=>{$(t).hasClass("answering")&&$(t).removeClass("answering")}),n.addClass("answering")}clickBtns(){this.dom.btns.on("click",t=>{let e=t.target;$(e).hasClass("btn-next")?this.handleNext():this.handleAhead()})}clickItem(){this.dom.examUl.on("click",t=>{let e=t.target,n=this.data.data.length;this.save(),this.index=$(e).index(),this.current=this.data.data[this.index],this.updateHeader(),this.updateMain(),this.recover(),this.updateFooter(e),this.index===n-1?this.dom.btns.find(".btn-next").text("完成练习"):this.dom.btns.find(".btn-next").text("下一题")})}handleNext(){let t=this.data.data.length;this.index<t-1?(this.save(),this.current=this.data.data[++this.index],this.updateHeader(),this.updateMain(),this.recover(),this.updateFooter(this.index),this.index===t-1?this.dom.btns.find(".btn-next").text("完成练习"):this.dom.btns.find(".btn-next").text("下一题")):(this.index=t-1,this.submit())}handleAhead(){}save(){let t=this.dom.form,e=t.find("input").toArray(),n={ans:"",seq:this.index,type:this.current.type};e.length?e.forEach((t,e)=>{t.checked&&(n.ans+=e)}):n.ans=t.find("textarea").val(),n.ans&&(this.answer[this.index]?this.answer[this.index].ans!==n.ans&&(this.answer[this.index].ans=n.ans):this.answer.push(n))}recover(){let t,e=this.index;if(this.answer[e]&&(t=this.answer[e].ans),t){let e=this.dom.form.find("input").toArray();if(e.length){let n=t.split(""),r=n.length;for(let t=0;t<r;t++)e.forEach((e,r)=>{n[t]==r&&(e.checked=!0)})}else this.dom.form.find("textarea").val(t)}}submit(){this.save(),this.handleAnswer(),alert("完成")}handleAnswer(){let t=this.answer.map(t=>"简答"!==t.type?t.ans.split("").map(t=>String.fromCharCode(65+parseInt(t))).join(""):t.ans);$.post("/api/exam_submit",`paperAnswer=${JSON.stringify(t)}`).done(t=>{t.ret&&(location.href="./personal.html")})}}).init()})},8:function(t,e){}});
//# sourceMappingURL=practice.bundle.js.map
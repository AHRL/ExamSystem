!function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=9)}({9:function(e,t){$(document).ready(function(){(new class{constructor(){this.regx={email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,pswd:/^[a-zA-Z0-9!@#$%^&*]{6,16}$/},this.$formIn=$("formIn"),this.$emailIn=$("emailIn"),this.$pswdIn=$("pswdIn"),this.$submitIn=$("#submitIn"),this.$logIn=$("#loginIn"),this.$formUp=$("formUp"),this.$emailUp=$("#emailUp"),this.$nameUp=$("#nameUp"),this.$pswdUp=$("#pswdUp"),this.$enPswdUp=$("#enPswdUp"),this.$valCode=$("#valCode"),this.$getValCodeBtn=$("#sendValCode"),this.$submitUp=$("#submitUp"),this.$logUp=$("#logUp"),this.flag={email:!1,name:!1,pswd:!1,enPswd:!1,valCode:!1}}init(){this.submitIn(),this.checkEmailUp(),this.checkNameUp(),this.checkPswdUp(),this.checkEnPswdUp(),this.getValCode(),this.submitUp()}checkEmailIn(){this.$emailIn.on("blur",e=>{const t=this.$emailIn.val();let s;t&&((s=this.check("email",t))?$.get("/api/isEmailExist").then(e=>{const t=(e=JSON.parse(e)).data;e.ret&&t?!1===t.isExist&&(this.fadeIn("该用户未被注册"),this.flag.email=!1):this.flag.email=!0}).fail(e=>{console.error(e)}):(this.fadeIn("用户名不正确"),this.flag.email=!1))})}checkPswdIn(){this.$pswdIn.on("blur",e=>{const t=this.$pswdIn.val();let s;t&&((s=this.check("pswd",t))?this.flag.pswd=!0:(this.fadeIn("密码不符合要求"),this.flag.pswd=!1))})}submitIn(){this.$submitIn.on("click",e=>{this.$formIn.submit()})}checkEmailUp(){this.$emailUp.on("blur",e=>{const t=this.$emailUp.val();let s;t&&((s=this.check("email",t))?$.get("/api/isEmailExist",`email=${t}`).then(e=>{!0===(e=JSON.parse(e)).ret?this.flag.email=!0:(this.fadeUp("邮箱已被注册"),this.flag.email=!1)}).fail(e=>{console.error(e)}):(this.fadeUp("邮箱格式不正确"),this.flag.email=!1))})}checkNameUp(){this.$nameUp.on("blur",e=>{const t=this.$nameUp.val();let s;t&&((s=this.check("name",t))?$.get("/api/isUsernameExist",`username=${t}`).then(e=>{!0===(e=JSON.parse(e)).ret?this.flag.name=!0:(this.fadeUp("用户名已被注册"),this.flag.name=!1)}).fail(e=>{console.error(e)}):(this.fadeUp("姓名不符合要求"),this.flag.name=!1))})}checkPswdUp(){this.$pswdUp.on("blur",e=>{const t=this.$pswdUp.val();let s;t&&((s=this.check("pswd",t))?this.flag.pswd=!0:(this.fadeUp("密码不符合要求"),this.flag.pswd=!1))})}checkEnPswdUp(){this.$enPswdUp.on("blur",e=>{const t=this.$enPswdUp.val();console.log(t),this.$pswdUp.val()!==t?(this.fadeUp("两次密码不一致"),this.flag.enPswd=!1):this.flag.enPswd=!0})}getValCode(){this.$getValCodeBtn.on("click",e=>{e.preventDefault();const t=this.$emailUp.val();$.post("/api/getValCode",`email=${t}`).then(e=>{const t=(e=JSON.parse(e)).valCode;e.ret&&(this.$valCode.on("blur",e=>{console.log(111111),this.$valCode.val()!==t?(console.log("zxcvbnm"),this.fadeUp("验证码不正确"),this.flag.valCode=!1):this.flag.valCode=!0}),this.dealEmailCountingDown(this.$getValCodeBtn,function(e){e.addClass("disabled").attr("disabled","true")},function(e){e.removeClass("disabled").removeAttr("disabled")}))}).fail(e=>{this.flag.valCode=!1})})}submitUp(){this.$submitUp.on("click",e=>{e.preventDefault(),console.log(this.flag),this.flag.email&&this.flag.name&&this.flag.pswd&&this.flag.enPswd&&this.flag.valCode?(console.log(1),$.post("/api/register",`email=${this.$emailUp.val()}&&username=${this.$nameUp.val()}&&password=${this.$pswdUp.val()}`).done(e=>{(e=JSON.parse(e)).ret&&alert("注册成功")})):console.log(0)})}dealEmailCountingDown(e,t,s){e=e instanceof $?e:$(e),t&&t instanceof Function&&t(e),this.countingDown(e,60,s)()}countingDown(e,t,s){const i=this;return function(){t-=1,$(e).text(t+"秒后重新获取验证码");var a=null;0!==t?a=setTimeout(i.countingDown($(e),t,s),1e3):(clearTimeout(a),$(e).text("获取邮箱验证码"),s&&s instanceof Function&&s(e))}}fadeIn(e){this.$logIn.text(e).fadeIn("fast").fadeOut(2e3)}fadeUp(e){this.$logUp.text(e).fadeIn("fast").fadeOut(2e3)}check(e,t){let s="";switch(e){case"email":s=t.split(/\s*, \s*/g).every(e=>this.regx.email.test(e));break;case"name":s=!!t.length;break;case"pswd":s=t.length>=6&&t.length<=16}return console.log(s),s}}).init()})}});
//# sourceMappingURL=login.bundle.js.map